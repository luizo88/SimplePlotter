<Window
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SimplePlotterView"
        xmlns:oxy="http://oxyplot.org/wpf"
        x:Class="SimplePlotterView.MainWindow"
        mc:Ignorable="d"
        Title="SimplePlotter" Height="900" Width="1200" WindowState="Maximized" Icon="Resources/SimplePlotterIcon16x16.ico">
    <Window.Resources>
        <ResourceDictionary Source="pack://application:,,,/SimplePlotterView;component/WindowsResources/ResourceDictionary.xaml" />
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="23"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="400*"/>
        </Grid.ColumnDefinitions>
        <Menu Name="mainMenu" Margin="0,0,0,0" Grid.ColumnSpan="3">
            <MenuItem Name="menuFile" Header="{Binding Vocabulary.File, FallbackValue=File}">
                <MenuItem Name="menuOpen" Header="{Binding Vocabulary.Open, FallbackValue=Open}" Command="{Binding OpenFileCommand}">
                    <MenuItem.Icon>
                        <Image Source="Resources/Open.ico" Height="16"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Name="menuSave" Header="{Binding Vocabulary.Save, FallbackValue=Save}" Command="{Binding SaveFileCommand}">
                    <MenuItem.Icon>
                        <Image Source="Resources/Save.ico" Height="16"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <MenuItem Name="menuLanguage" Header="{Binding Vocabulary.Language, FallbackValue=Language}">
                <MenuItem Name="menuInterface" Header="{Binding Vocabulary.Interface, FallbackValue=Interface}" IsEnabled="True">
                    <MenuItem.Icon>
                        <Image Source="Resources/Language.ico" Height="16"/>
                    </MenuItem.Icon>
                    <MenuItem Name="menuIntPT" Header="PT" Command="{Binding InterfaceLanguageChangeCommand}" CommandParameter="0">
                        <MenuItem.Icon>
                            <Image Source="Resources/PT.ico" Height="16"/>
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Name="menuIntES" Header="ES" Command="{Binding InterfaceLanguageChangeCommand}"  CommandParameter="1">
                        <MenuItem.Icon>
                            <Image Source="Resources/ES.ico" Height="16"/>
                        </MenuItem.Icon>
                    </MenuItem>
                    <MenuItem Name="menuIntEN" Header="EN" Command="{Binding InterfaceLanguageChangeCommand}"  CommandParameter="2">
                        <MenuItem.Icon>
                            <Image Source="Resources/EN.ico" Height="16"/>
                        </MenuItem.Icon>
                    </MenuItem>
                </MenuItem>
            </MenuItem>
        </Menu>
        <Label Name="lblVersion" Content="{Binding Version, FallbackValue='v. x.X.X.X'}" HorizontalAlignment="Right" Grid.Column="2" Margin="0,0,0,0"/>
        <Expander Name="expd0" Margin="5,5,0,35" Grid.Row="1" Grid.Column="0" ExpandDirection="Right" IsExpanded="True">
            <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="0,0,0,0" Grid.Row="1">
                <Grid Background="#FFF7FAFD" HorizontalAlignment="Left" Width="540">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Expander Name="ExpdDataSeries" Margin="10,10,10,10" Grid.Row="0" BorderBrush="DarkGray" IsExpanded="True">
                        <Expander.Header>
                            <DockPanel Width="495" Height="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType={x:Type ToggleButton}, Mode=FindAncestor}}">
                                <DockPanel.Background>
                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                        <GradientStop Color="DarkGray" Offset="1"/>
                                        <GradientStop Color="LightGray"/>
                                    </LinearGradientBrush>
                                </DockPanel.Background>
                                <TextBlock Name="txtDataSeries" Text="{Binding Vocabulary.DataSeries, FallbackValue=DataSeries}" FontWeight="Bold" HorizontalAlignment="Center"/>
                            </DockPanel>
                        </Expander.Header>
                        <Grid Height="400">
                            <Button Command="{Binding AddDataSeries}" Content="{Binding Vocabulary.AddDataSeries, FallbackValue=AddDataSeries}" HorizontalAlignment="Left" Margin="5,10,0,0" VerticalAlignment="Top" Width="150" Height="23"/>
                            <ListView Margin="5,40,10,0" ItemsSource="{Binding AvailableDataSeries}" SelectedItem="{Binding SelectedDataSeries, Mode=TwoWay}" Height="140" VerticalAlignment="Top" Grid.ColumnSpan="2" d:ItemsSource="{d:SampleData ItemCount=3}">
                                <ListView.ItemContainerStyle>
                                    <Style TargetType="{x:Type ListViewItem}">
                                        <Setter Property="Height" Value="Auto"/>
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                    </Style>
                                </ListView.ItemContainerStyle>
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn x:Name="Name" Header="{Binding Vocabulary.Name, FallbackValue=Name}">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBox Text="{Binding Name, Mode=TwoWay}" TextAlignment="Left" BorderThickness="0" Background="{x:Null}" IsEnabled="True" GotFocus="lvItem_GotFocus" KeyDown="lv_EnterPressed"/>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn x:Name="XScale" Header="{Binding Vocabulary.XScale, FallbackValue=XScale}">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBox Text="{Binding XScale, Mode=TwoWay}" TextAlignment="Center" BorderThickness="0" Background="{x:Null}" IsEnabled="True" GotFocus="lvItem_GotFocus" KeyDown="lv_EnterPressed"/>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn x:Name="YScale" Header="{Binding Vocabulary.YScale, FallbackValue=YScale}">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBox Text="{Binding YScale, Mode=TwoWay}" TextAlignment="Center" BorderThickness="0" Background="{x:Null}" IsEnabled="True" GotFocus="lvItem_GotFocus" KeyDown="lv_EnterPressed"/>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn x:Name="Thick" Header="{Binding Vocabulary.Thick, FallbackValue=Thick}">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBox Text="{Binding Thick, Mode=TwoWay}" TextAlignment="Center" BorderThickness="0" Background="{x:Null}" IsEnabled="True" GotFocus="lvItem_GotFocus" KeyDown="lv_EnterPressed"/>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn x:Name="Style" Header="{Binding Vocabulary.Style, FallbackValue=Style}">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <ComboBox ItemsSource="{Binding AvailableLineStyles}" SelectedItem="{Binding LineStyle}" BorderThickness="0" GotFocus="lvItem_GotFocus"/>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn x:Name="Color" Header="{Binding Vocabulary.Color, FallbackValue=Color}">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <ComboBox ItemsSource="{Binding AvailableColors}" SelectedItem="{Binding Color}" IsEnabled="{Binding StandardColor}" BorderThickness="0" GotFocus="lvItem_GotFocus"/>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn x:Name="CustomColor" Header="{Binding Vocabulary.CustomColor, FallbackValue=CustomColor}">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsChecked="{Binding CustomColor}" Content="" Background="{x:Null}" GotFocus="lvItem_GotFocus"/>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn x:Name="RGB" Header="{Binding Vocabulary.RGB, FallbackValue=RGB}">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBox Text="{Binding RGBDescription, Mode=TwoWay}" TextAlignment="Center" BorderThickness="0" Background="{x:Null}" IsEnabled="{Binding CustomColor}" GotFocus="lvItem_GotFocus" KeyDown="lv_EnterPressed"/>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn x:Name="Legend" Header="{Binding Vocabulary.Legend, FallbackValue=Legend}">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsChecked="{Binding Legend}" Content="" Background="{x:Null}" GotFocus="lvItem_GotFocus"/>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                    </GridView>
                                </ListView.View>
                            </ListView>
                            <Button Command="{Binding RemoveDataSeries}" Content="{Binding Vocabulary.RemoveDataSeries, FallbackValue=RemoveDataSeries}" HorizontalAlignment="Left" Margin="5,190,0,0" VerticalAlignment="Top" Width="150" Height="23"/>
                            <Button Command="{Binding DataSeriesUp}" Content="{Binding Vocabulary.ArrowUp, FallbackValue=ArrowUp}" HorizontalAlignment="Left" Margin="165,190,0,0" VerticalAlignment="Top" Width="50" Height="23"/>
                            <Button Command="{Binding DataSeriesDown}" Content="{Binding Vocabulary.ArrowDown, FallbackValue=ArrowDown}" HorizontalAlignment="Left" Margin="225,190,0,0" VerticalAlignment="Top" Width="50" Height="23"/>
                            <ListView Margin="5,230,10,0" ItemsSource="{Binding SelectedDataSeriesPoints}" Height="130" VerticalAlignment="Top" Grid.ColumnSpan="2" d:ItemsSource="{d:SampleData ItemCount=3}">
                                <ListView.ItemContainerStyle>
                                    <Style TargetType="{x:Type ListViewItem}">
                                        <Setter Property="Height" Value="Auto"/>
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                    </Style>
                                </ListView.ItemContainerStyle>
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn x:Name="OriginalX" Header="{Binding Vocabulary.OriginalX, FallbackValue=OriginalX}">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBox Text="{Binding X, Mode=TwoWay}" TextAlignment="Center" BorderThickness="0" Background="{x:Null}" IsEnabled="True" GotFocus="lvItem_GotFocus" KeyDown="lv_EnterPressed"/>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn x:Name="OriginalY" Header="{Binding Vocabulary.OriginalY, FallbackValue=OriginalY}">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBox Text="{Binding Y, Mode=TwoWay}" TextAlignment="Center" BorderThickness="0" Background="{x:Null}" IsEnabled="True" GotFocus="lvItem_GotFocus" KeyDown="lv_EnterPressed"/>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn x:Name="ScaledX" Header="{Binding Vocabulary.ScaledX, FallbackValue=ScaledX}">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBox Text="{Binding ScaledX}" TextAlignment="Center" BorderThickness="0" Background="{x:Null}" IsReadOnly="True" GotFocus="lvItem_GotFocus" KeyDown="lv_EnterPressed"/>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn x:Name="ScaledY" Header="{Binding Vocabulary.ScaledY, FallbackValue=ScaledY}">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBox Text="{Binding ScaledY}" TextAlignment="Center" BorderThickness="0" Background="{x:Null}" IsReadOnly="True" GotFocus="lvItem_GotFocus" KeyDown="lv_EnterPressed"/>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                    </GridView>
                                </ListView.View>
                            </ListView>
                            <Label Content="{Binding Vocabulary.ColorTemplate, FallbackValue=ColorTemplate}" Margin="10,370,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <ComboBox ItemsSource="{Binding AvailableColorTemplates}" SelectedItem="{Binding SelectedColorTemplate}" Margin="240,370,80,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <Button Command="{Binding ApplyColorTemplate}" Content="{Binding Vocabulary.Apply, FallbackValue=Apply}" Margin="450,370,20,0" VerticalAlignment="Top" Height="23"/>
                        </Grid>
                    </Expander>
                    <Expander Name="AxisConfiguration" Margin="10,10,10,10" Grid.Row="1" BorderBrush="DarkGray" IsExpanded="False">
                        <Expander.Header>
                            <DockPanel Width="495" Height="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType={x:Type ToggleButton}, Mode=FindAncestor}}">
                                <DockPanel.Background>
                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                        <GradientStop Color="DarkGray" Offset="1"/>
                                        <GradientStop Color="LightGray"/>
                                    </LinearGradientBrush>
                                </DockPanel.Background>
                                <TextBlock Name="txtAxisConfiguration" Text="{Binding Vocabulary.AxisConfiguration, FallbackValue=AxisConfiguration}" FontWeight="Bold" HorizontalAlignment="Center"/>
                            </DockPanel>
                        </Expander.Header>
                        <Grid Height="190">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="220"/>
                                <ColumnDefinition Width="300"/>
                            </Grid.ColumnDefinitions>
                            <Label Content="{Binding Vocabulary.XLimits, FallbackValue=XLimits}" Margin="10,10,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <Label Content="{Binding Vocabulary.YLimits, FallbackValue=YLimits}" Margin="10,40,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <Label Content="{Binding Vocabulary.XAxisTitle, FallbackValue=XAxisTitle}" Margin="10,70,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <Label Content="{Binding Vocabulary.YAxisTitle, FallbackValue=YAxisTitle}" Margin="10,100,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <Label Content="{Binding Vocabulary.LogarithmicScale, FallbackValue=LogarithmicScale}" Margin="10,130,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <Label Content="{Binding Vocabulary.AxisLabelsStyle, FallbackValue=AxisLabelsStyle}" Margin="10,160,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <CheckBox IsChecked="{Binding ManualXMinAxisLimit}" Margin="3,13,282,0" VerticalAlignment="Top" Grid.Column="1" Height="15"/>
                            <TextBox Text="{Binding XAxisMin, UpdateSourceTrigger=LostFocus}" IsEnabled="{Binding ManualXMinAxisLimit}" Margin="20,10,210,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <CheckBox IsChecked="{Binding ManualXMaxAxisLimit}" Margin="93,13,192,0" VerticalAlignment="Top" Grid.Column="1" Height="15"/>
                            <TextBox Text="{Binding XAxisMax, UpdateSourceTrigger=LostFocus}" IsEnabled="{Binding ManualXMaxAxisLimit}" Margin="110,10,120,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <CheckBox IsChecked="{Binding ManualYMinAxisLimit}" Margin="3,43,282,0" VerticalAlignment="Top" Grid.Column="1" Height="15"/>
                            <TextBox Text="{Binding YAxisMin, UpdateSourceTrigger=LostFocus}" IsEnabled="{Binding ManualYMinAxisLimit}" Margin="20,40,210,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <CheckBox IsChecked="{Binding ManualYMaxAxisLimit}" Margin="93,43,192,0" VerticalAlignment="Top" Grid.Column="1" Height="15"/>
                            <TextBox Text="{Binding YAxisMax, UpdateSourceTrigger=LostFocus}" IsEnabled="{Binding ManualYMaxAxisLimit}" Margin="110,40,120,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <TextBox Text="{Binding XAxisTitle, UpdateSourceTrigger=LostFocus}" Margin="20,70,20,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <TextBox Text="{Binding YAxisTitle, UpdateSourceTrigger=LostFocus}" Margin="20,100,20,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <CheckBox IsChecked="{Binding XLogarithmicScale}" Content="X" Margin="20,130,20,0" VerticalAlignment="Top" Grid.Column="1" Height="15"/>
                            <CheckBox IsChecked="{Binding YLogarithmicScale}" Content="Y" Margin="100,130,20,0" VerticalAlignment="Top" Grid.Column="1" Height="15"/>
                            <ComboBox ItemsSource="{Binding AvailableAxisLabelFormats}" SelectedItem="{Binding SelectedXAxisLabelFormat}" Margin="20,160,180,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <ComboBox ItemsSource="{Binding AvailableAxisLabelFormats}" SelectedItem="{Binding SelectedYAxisLabelFormat}" Margin="140,160,60,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                        </Grid>
                    </Expander>
                    <Expander Name="GridLines" Margin="10,10,10,10" Grid.Row="2" BorderBrush="DarkGray" IsExpanded="False">
                        <Expander.Header>
                            <DockPanel Width="495" Height="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType={x:Type ToggleButton}, Mode=FindAncestor}}">
                                <DockPanel.Background>
                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                        <GradientStop Color="DarkGray" Offset="1"/>
                                        <GradientStop Color="LightGray"/>
                                    </LinearGradientBrush>
                                </DockPanel.Background>
                                <TextBlock Name="txtGridLines" Text="{Binding Vocabulary.GridLines, FallbackValue=GridLines}" FontWeight="Bold" HorizontalAlignment="Center"/>
                            </DockPanel>
                        </Expander.Header>
                        <Grid Height="130">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="220"/>
                                <ColumnDefinition Width="300"/>
                            </Grid.ColumnDefinitions>
                            <Label Content="{Binding Vocabulary.MajorGridLines, FallbackValue=MajorGridLines}" Margin="10,10,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <Label Content="{Binding Vocabulary.MinorGridLines, FallbackValue=MinorGridLines}" Margin="10,40,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <Label Content="{Binding Vocabulary.MajorStep, FallbackValue=MajorStep}" Margin="10,70,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <Label Content="{Binding Vocabulary.MinorStep, FallbackValue=MinorStep}" Margin="10,100,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <CheckBox IsChecked="{Binding XMajorGridLines}" Content="X" Margin="20,10,20,0" VerticalAlignment="Top" Grid.Column="1" Height="15"/>
                            <CheckBox IsChecked="{Binding YMajorGridLines}" Content="Y" Margin="100,10,20,0" VerticalAlignment="Top" Grid.Column="1" Height="15"/>
                            <CheckBox IsChecked="{Binding XMinorGridLines}" Content="X" Margin="20,40,20,0" VerticalAlignment="Top" Grid.Column="1" Height="15"/>
                            <CheckBox IsChecked="{Binding YMinorGridLines}" Content="Y" Margin="100,40,20,0" VerticalAlignment="Top" Grid.Column="1" Height="15"/>
                            <TextBox Text="{Binding XMajorStep, UpdateSourceTrigger=LostFocus}" Margin="20,70,210,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <TextBox Text="{Binding YMajorStep, UpdateSourceTrigger=LostFocus}" Margin="110,70,120,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <TextBox Text="{Binding XMinorStep, UpdateSourceTrigger=LostFocus}" Margin="20,100,210,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <TextBox Text="{Binding YMinorStep, UpdateSourceTrigger=LostFocus}" Margin="110,100,120,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                        </Grid>
                    </Expander>
                    <Expander Name="ChartBox" Margin="10,10,10,10" Grid.Row="3" BorderBrush="DarkGray" IsExpanded="False">
                        <Expander.Header>
                            <DockPanel Width="495" Height="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType={x:Type ToggleButton}, Mode=FindAncestor}}">
                                <DockPanel.Background>
                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                        <GradientStop Color="DarkGray" Offset="1"/>
                                        <GradientStop Color="LightGray"/>
                                    </LinearGradientBrush>
                                </DockPanel.Background>
                                <TextBlock Name="txtChartBox" Text="{Binding Vocabulary.ChartBox, FallbackValue=ChartBox}" FontWeight="Bold" HorizontalAlignment="Center"/>
                            </DockPanel>
                        </Expander.Header>
                        <Grid Height="130">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="220"/>
                                <ColumnDefinition Width="300"/>
                            </Grid.ColumnDefinitions>
                            <Label Content="{Binding Vocabulary.ChartSize, FallbackValue=ChartSize}" Margin="10,10,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <Label Content="{Binding Vocabulary.ChartTitle, FallbackValue=ChartTitle}" Margin="10,40,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <Label Content="{Binding Vocabulary.ShowLegend, FallbackValue=ShowLegend}" Margin="10,70,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <Label Content="{Binding Vocabulary.LegendPosition, FallbackValue=LegendPosition}" Margin="10,100,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <TextBox Text="{Binding ChartWidth, UpdateSourceTrigger=LostFocus}" Margin="20,10,210,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <TextBox Text="{Binding ChartHeight, UpdateSourceTrigger=LostFocus}" Margin="110,10,120,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <TextBox Text="{Binding ChartTitle, UpdateSourceTrigger=LostFocus}" Margin="20,40,20,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <CheckBox IsChecked="{Binding ShowLegend}" Margin="20,70,20,0" VerticalAlignment="Top" Grid.Column="1" Height="15"/>
                            <ComboBox ItemsSource="{Binding AvailableLegendPositions}" SelectedItem="{Binding SelectedLegendPosition}" Margin="20,100,20,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                        </Grid>
                    </Expander>
                    <Expander Name="ChartFontStyle" Margin="10,10,10,10" Grid.Row="4" BorderBrush="DarkGray" IsExpanded="False">
                        <Expander.Header>
                            <DockPanel Width="495" Height="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType={x:Type ToggleButton}, Mode=FindAncestor}}">
                                <DockPanel.Background>
                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                        <GradientStop Color="DarkGray" Offset="1"/>
                                        <GradientStop Color="LightGray"/>
                                    </LinearGradientBrush>
                                </DockPanel.Background>
                                <TextBlock Name="txtFontStyle" Text="{Binding Vocabulary.FontStyle, FallbackValue=FontStyle}" FontWeight="Bold" HorizontalAlignment="Center"/>
                            </DockPanel>
                        </Expander.Header>
                        <Grid Height="130">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="220"/>
                                <ColumnDefinition Width="300"/>
                            </Grid.ColumnDefinitions>
                            <Label Content="{Binding Vocabulary.FontName, FallbackValue=FontName}" Margin="10,10,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <Label Content="{Binding Vocabulary.AxisFontSize, FallbackValue=AxisFontSize}" Margin="10,40,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <Label Content="{Binding Vocabulary.TitleFontSize, FallbackValue=TitleFontSize}" Margin="10,70,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <Label Content="{Binding Vocabulary.LegendFontSize, FallbackValue=LegendFontSize}" Margin="10,100,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <ComboBox ItemsSource="{Binding AvailableFonts}" SelectedItem="{Binding SelectedFont}" Margin="20,10,20,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <TextBox Text="{Binding XAxisFontSize, UpdateSourceTrigger=LostFocus}" Margin="20,40,210,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <TextBox Text="{Binding YAxisFontSize, UpdateSourceTrigger=LostFocus}" Margin="110,40,120,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <TextBox Text="{Binding TitleFontSize, UpdateSourceTrigger=LostFocus}" Margin="20,70,210,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <TextBox Text="{Binding LegendFontSize, UpdateSourceTrigger=LostFocus}" Margin="20,100,210,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                        </Grid>
                    </Expander>
                    <Expander Name="Colors" Margin="10,10,10,10" Grid.Row="5" BorderBrush="DarkGray" IsExpanded="False">
                        <Expander.Header>
                            <DockPanel Width="495" Height="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType={x:Type ToggleButton}, Mode=FindAncestor}}">
                                <DockPanel.Background>
                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                        <GradientStop Color="DarkGray" Offset="1"/>
                                        <GradientStop Color="LightGray"/>
                                    </LinearGradientBrush>
                                </DockPanel.Background>
                                <TextBlock Name="txtColors" Text="{Binding Vocabulary.Colors, FallbackValue=Colors}" FontWeight="Bold" HorizontalAlignment="Center"/>
                            </DockPanel>
                        </Expander.Header>
                        <Grid Height="100">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="220"/>
                                <ColumnDefinition Width="300"/>
                            </Grid.ColumnDefinitions>
                            <Label Content="{Binding Vocabulary.BackColor, FallbackValue=BackColor}" Margin="10,10,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <ComboBox ItemsSource="{Binding AvailableColors}" SelectedItem="{Binding SelectedBackColor}" IsEnabled="{Binding StandardBackColor}" Margin="20,10,150,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <CheckBox IsChecked="{Binding CustomBackColor}" Margin="160,10,20,0" VerticalAlignment="Top" Grid.Column="1" Height="15"/>
                            <TextBox Text="{Binding BackColorRGBDescription, UpdateSourceTrigger=LostFocus}" IsEnabled="{Binding CustomBackColor}" Margin="180,10,20,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <Label Content="{Binding Vocabulary.BackgroundColor, FallbackValue=BackgroundColor}" Margin="10,40,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <ComboBox ItemsSource="{Binding AvailableColors}" SelectedItem="{Binding SelectedBackgroundColor}" IsEnabled="{Binding StandardBackgroundColor}" Margin="20,40,150,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <CheckBox IsChecked="{Binding CustomBackgroundColor}" Margin="160,40,20,0" VerticalAlignment="Top" Grid.Column="1" Height="15"/>
                            <TextBox Text="{Binding BackgroundColorRGBDescription, UpdateSourceTrigger=LostFocus}" IsEnabled="{Binding CustomBackgroundColor}" Margin="180,40,20,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <Label Content="{Binding Vocabulary.GridLinesColor, FallbackValue=GridLinesColor}" Margin="10,70,10,0" VerticalAlignment="Top" Grid.Column="0"/>
                            <ComboBox ItemsSource="{Binding AvailableColors}" SelectedItem="{Binding SelectedGridLinesColor}" IsEnabled="{Binding StandardGridLinesColor}" Margin="20,70,150,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                            <CheckBox IsChecked="{Binding CustomGridLinesColor}" Margin="160,70,20,0" VerticalAlignment="Top" Grid.Column="1" Height="15"/>
                            <TextBox Text="{Binding GridLinesColorRGBDescription, UpdateSourceTrigger=LostFocus}" IsEnabled="{Binding CustomGridLinesColor}" Margin="180,70,20,0" VerticalAlignment="Top" Grid.Column="1" Height="23"/>
                        </Grid>
                    </Expander>
                </Grid>
            </ScrollViewer>
        </Expander>
        <Grid Grid.Column="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <Button Content="{Binding Vocabulary.RefreshPlot, FallbackValue=RefreshPlot}" Command="{Binding RefreshPlot}" HorizontalAlignment="Left" Margin="5,0,5,0" VerticalAlignment="Center" Grid.Column="0"/>
            <Button Content="{Binding Vocabulary.CopyPlotToClipboard, FallbackValue=CopyPlotToClipboard}" Command="{Binding CopyPlotToClipboard}" HorizontalAlignment="Left" Margin="5,0,5,0" VerticalAlignment="Center" Grid.Column="1"/>
            <Button Content="{Binding Vocabulary.ExportPlot, FallbackValue=ExportPlot}" Command="{Binding ExportPlot}" HorizontalAlignment="Left" Margin="5,0,5,0" VerticalAlignment="Center" Grid.Column="2"/>
        </Grid>
        <Grid Name="PlotRef1" Grid.Column="1" Grid.Row="1" VerticalAlignment="Top" HorizontalAlignment="Left" Width="{Binding ChartWidth}" Height="{Binding ChartHeight}"/>
        <Grid Name="PlotRef2" Grid.Column="1" Grid.Row="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
        <Grid Name="PlotGrid" Grid.Column="1" Grid.Row="1">
            <Grid.Resources>
                <local:MaxSizeConverter x:Key="MaxSizeConverter"></local:MaxSizeConverter>
            </Grid.Resources>
            <oxy:PlotView Name="Plot" Model="{Binding PlotObj}" Margin="0,0,0,0">
                <oxy:PlotView.Width>
                    <MultiBinding Converter="{StaticResourceExtension MaxSizeConverter}">
                        <Binding ElementName="PlotRef1" Path="Width"/>
                        <Binding ElementName="PlotRef2" Path="ActualWidth" />
                    </MultiBinding>
                </oxy:PlotView.Width>
                <oxy:PlotView.Height>
                    <MultiBinding Converter="{StaticResourceExtension MaxSizeConverter}">
                        <Binding ElementName="PlotRef1" Path="Height"/>
                        <Binding ElementName="PlotRef2" Path="ActualHeight" />
                    </MultiBinding>
                </oxy:PlotView.Height>
            </oxy:PlotView>
        </Grid>
    </Grid>
</Window>
